<div id="similarity_modal" class="modal">
    <div class="modal-content wide">
        <div class="modal-header">
            <h4>Character Similarity Analysis</h4>
            <div id="similarity_close_button" class="modal-close-button">
                <i class="fa-solid fa-xmark"></i>
            </div>
        </div>
        <div class="modal-body">
            <p>This tool analyzes all your characters using text embeddings to find semantic similarities. It calculates the cosine similarity score between each pair of characters based on their description and first message. A score of 1 indicates identical characters, while -1 indicates complete dissimilarity.</p>
            <p><b>Warning:</b> This process can be slow and resource-intensive, especially with a large number of characters. It requires the 'Summarize & Embed' module to be enabled in your SillyTavern Extras server.</p>
            <div class="flex-container">
                 <button id="start_similarity_analysis" class="menu_button">
                    <i class="fa-solid fa-play"></i> Start Analysis
                </button>
            </div>
            <div id="similarity_progress_container" class="hidden">
                <p id="similarity_progress_text">Starting...</p>
                <progress id="similarity_progress_bar" value="0" max="100"></progress>
            </div>
            <div class="table-container">
                <table id="similarity_results_table">
                    <thead>
                        <tr>
                            <th data-column="0" data-sort-dir="none">Character 1</th>
                            <th data-column="1" data-sort-dir="none">Character 2</th>
                            <th data-column="2" data-sort-dir="desc">Similarity Score <i class="fa-solid fa-sort"></i></th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Results will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>